<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .admin-actions { margin-bottom: 20px; display: flex; gap: 15px; flex-wrap: wrap; }
        .btn-pdf { background-color: #2e7d32; color: white; border: none; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: bold; }
        .btn-toggle-edit { background-color: #f39c12; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-delete { background-color: #d32f2f; color: white; border: none; padding: 12px 25px; cursor: pointer; border-radius: 5px; margin-top: 15px; font-weight: bold; width: 100%; }
        
        /* Ø¥Ø®ÙØ§Ø¡ Ø¹Ù…ÙˆØ¯ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ ÙˆØ²Ø± Ø§Ù„Ø­Ø°Ù ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        .select-col { display: none; text-align: center; width: 50px; }
        #deleteBtnContainer { display: none; }
        
        .edit-mode .select-col { display: table-cell; }
        .alert { padding: 10px; margin-bottom: 15px; border-radius: 5px; background-color: #e8f5e9; color: #2e7d32; text-align: center; }
    </style>
</head>
<body>

    <div class="admin-container">
        <div class="logo-header">
            <img src="{{ url_for('static', filename='logo_gov_sharjah.png') }}" alt="Ø´Ø¹Ø§Ø± Ø­ÙƒÙˆÙ…Ø© Ø§Ù„Ø´Ø§Ø±Ù‚Ø©" class="logo left-logo">
            <img src="{{ url_for('static', filename='logo_sharjah_police.png') }}" alt="Ø´Ø¹Ø§Ø± Ø´Ø±Ø·Ø© Ø§Ù„Ø´Ø§Ø±Ù‚Ø©" class="logo right-logo">
        </div>

        <h2 style="text-align: center; margin-bottom: 30px;">Ø³Ø¬Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª - Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ…</h2>

        <div class="admin-actions">
            <a href="{{ url_for('download_pdf', code=request.args.get('code')) }}" class="btn-pdf">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„ PDF</a>
            <button type="button" class="btn-toggle-edit" onclick="toggleEditMode()">âœï¸ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ù„Ø­Ø°Ù</button>
        </div>

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            {% for message in messages %}
              <div class="alert">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <form id="adminForm" action="{{ url_for('delete_logs', code=request.args.get('code')) }}" method="POST">
            <div class="data-table-wrapper">
                <table class="data-table" id="adminTable">
                    <thead>
                        <tr>
                            <th class="select-col">ØªØ­Ø¯ÙŠØ¯</th>
                            <th>#</th>
                            <th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</th>
                            <th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ</th>
                            <th>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</th>
                            <th>Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ§Ø±ÙŠØ®</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for log in logs %}
                        <tr>
                            <td class="select-col">
                                <input type="checkbox" name="log_ids" value="{{ log.id }}">
                            </td>
                            <th>{{ log.id }}</th>
                            <td>{{ log.username }}</td>
                            <td>{{ log.military_id }}</td>
                            <td>{{ log.car_type }}</td>
                            <td>{{ log.timestamp | format_datetime_uae }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <div id="deleteBtnContainer">
                <button type="submit" class="btn-delete" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŸ')">âŒ Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</button>
            </div>
        </form>

        <a href="{{ url_for('index') }}" class="back-button" style="display: block; text-align: center; margin-top: 20px; text-decoration: none;">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØµÙØ­Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„</a>
    </div>

    <script>
    function toggleEditMode() {
        var table = document.getElementById("adminTable");
        var deleteBtnDiv = document.getElementById("deleteBtnContainer");
        var btnToggle = document.querySelector(".btn-toggle-edit");
        
        table.classList.toggle("edit-mode");
        
        if (table.classList.contains("edit-mode")) {
            deleteBtnDiv.style.display = "block";
            btnToggle.innerText = "ğŸ”’ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„";
            btnToggle.style.backgroundColor = "#666";
        } else {
            deleteBtnDiv.style.display = "none";
            btnToggle.innerText = "âœï¸ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ù„Ø­Ø°Ù";
            btnToggle.style.backgroundColor = "#f39c12";
        }
    }
    </script>
</body>
</html>